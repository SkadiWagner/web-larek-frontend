# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

# Документация

## Общие типы

```TypeScript 

// Тип с категориями товаров.
type TCategory = "софт-скилл" | "другое" | "дополнительное" | "кнопка" | "хард-скилл";

// Тип с методами оплаты.
type TPayment = "онлайн" | "при получении"; 

```

## Базовые классы

__Api__

Класс Api является обобщённым модулем для выполнения HTTP-запросов к API, который позволяет отправлять GET и POST (включая PUT и DELETE) запросы. Ниже приведено подробное описание данного класса, включая его конструктор и методы.

constructor(baseUrl: string, options: RequestInit = {})- принимает базовый URL и глобальные опции для всех запросов(опционально).

Методы:

handleResponse() - Обрабатывает ответ от сервера
get() - Выполняет GET-запрос к API по указанному URI
post() - Выполняет POST-запрос (или PUT/DELETE, в зависимости от параметра method) к API по указанному URI с переданными данными.

__Component<T>__

Класс Component<T> представляет собой абстрактный базовый компонент для работы с DOM-элементами. Он используется для создания компонентов с общими инструментами для манипуляции DOM в дочерних классах.

constructor(protected readonly container: HTMLElement) - принимает корневой DOM - элемент, который будет использоватся как контейнер для компонента.

Методы:

toggleClass() - Переключает css класс у элемента.
setText() - Устанавливает текстовое содержимое элемента.
setDisabled() -  Устанавливает или снимает атрибут disabled у элемента.
setHidden() - Устанавливает элементу стиль display: none, скрывая его.
setVisible() - Удаляет стиль display, делая элемент видимым.
setImage() - Устанавливает изображение и альтернативный текст для элемента
render() - Метод рендеринга компонента. Принимает объект данных и назначает его текущему экземпляру, после чего возвращает корневой DOM-элемент компонента.


__EventEmitter__

Хранилище для событий и соответствующих обработчиков. Ключами являются имена событий, значениями — множества обработчиков.

constructor() - Инициализирует пустую карту _events для хранения событий и их обработчиков.

Методы:

on() - Устанавливает обработчик на событие с указанным именем.
off() - Снимает обработчик с события.
emit() - Инициирует событие с указанными данными, вызывая все обработчики, подписанные на это событие.
onAll() - Устанавливает обработчик для прослушивания всех событий.
offAll() - Снимает все обработчики со всех событий.
trigger() -  Создаёт функцию, которая инициирует событие при вызове.

## Слой Model

Слой Model в архитектуре MVP (Model-View-Presenter) отвечает за представление и управление данными  приложения. Он абстрагирует и управляет бизнес-логикой, а также взаимодействует с источниками данных, такими как базы данных или API, предоставляя View и Presenter доступ к этим данным
 
```TypeScript 

Модель карточки продукта. 

interface IProductItem {
    id: string; // id 
    description: string; // описание 
    image: string; // изображение 
    title: string; // название
    category: TCategory; // категория
    price: number; // цена
}

Модель списка всех товаров. Используется для Api клиента.

interface IProductListDto {
    items: IProductItem[]; // массив продуктов
}

Модель корзины

interface ICart {
    items: IProductItem[];
    total: number;
    addProduct(productId: string): void; // метод добавления товаров в корзину
	removeProduct(productId: string): void // метод удаления товара
	createOrder(): void 
}

Модель заказа

interface IOrder {
    payment: TPayment; // способ оплаты
    email: string; // контактная почта
    phone: string; // контактный телефон
    address: string; // адресс доставки 
    total: number; // итоговая стоимость
    items: string[]; // товары в корзине

}

```
## Слой View
```TypeScript 

__Класс PageComponent__ наследуется от абстрактного класса Component, отображает представление главной страницы. Содержит список всех продуктов, счетчик товаров в корзине.

constructor(container: HTMLElement, protected events: IEvents) - в конструкторе принимает контейнер, который является родителем, а также events - методы presenter слоя для взаимодействия view и modal. Имплементирует  интерфейс IPageView.

interface IPageView {
	_counter: number; // Счетчик товаров в корзине
	_cardList: HTMLElement[]; // Список продуктов на странице
} 

__Класс CardComponent__ наследуется от абстрактного класса Component, используется в различных компонентах ( корзина, галерея , каталог главной страницы). 

constructor(container: HTMLElement, productData: IProductItem, events: IEvents) - в конструкторе принимает контейнер, который является родителем, а также events - методы presenter слоя для взаимодействия view и modal и обязательно данные карточки. Имплементирует  интерфейс ICardView.

interface ICardView {
	title: HTMLHeadingElement; // Заголовок продукта
	price: HTMLSpanElement; // Цена продукта 
	button: HTMLButtonElement; // Кнопка
	category?: HTMLSpanElement; // Категория продукта (необязательно)
    description?: HTMLParagraphElement; // Описание продукта (необязательно)
    image?: HTMLImageElement; // Изображение продукта (необязательно)
}

__Класс CartComponent__ наследуется от абстрактного класса Component, компонент содержащий список продуктов, добавленных в корзину, а также итоговую стоимость. С данного компонента осущесвтляется начало процедуры оформления заказа.

 constructor(container: HTMLElement, events: IEvents) - в конструкторе принимает контейнер, который является родителем, а также events - методы presenter слоя для взаимодействия view и modal. Имплементирует  интерфейс ICartView.

interface ICartView {
	productList: HTMLElement[]; // Список продуктов в корзине
	totalPrice: number; // Итоговая стоимость корзины
} 

__Класс Modal__ наследуется от абстрактного класса Component, компонент модального окна, ожидает контент для отображения. Помимо наследуемых от абстрактного копмонента методов имеет свои ( Открытие и Закрытие)

constructor(container: HTMLElement, protected events: IEvents) - в конструкторе принимает контейнер, который является родителем, а также events - методы presenter слоя для взаимодействия view и modal. Имплементирует  интерфейс IModalView.

interface IModalView extends Component<IModalContent> {
	open(): void; // метод открытия модального окна
    close(): void; // метод закрытия модального окна
}

__Вспомогательный интерфейс IModalContent__, принимающий контент для модального окна в качестве HTMLElementa.  

interface IModalContent {
    content: HTMLElement; // Содержимое модального окна
}

__Класс Form__ универсальный компонент формы. Его наследуют другие формы в проекте. 

constructor(protected container: HTMLFormElement, protected events: IEvents) - в конструкторе принимает контейнер, который является родителем, а также events - методы presenter слоя для взаимодействия view и modal. Имплементирует  интерфейс IFormView.

interface IFormView {
	isValid: boolean; // проверка валидности формы
}

__Класс FormAddressComponent__ наследуется от универсального компонента Form. Является формой с 2 полями ( метод оплаты, адресс). Валидируется.

constructor(container: HTMLFormElement, events: IEvents ) - в конструкторе принимает контейнер, который является родителем, а также events - методы presenter слоя для взаимодействия view и modal. Имплементирует  интерфейс IFormDeliveryView.

interface IFormDeliveryView {
	payment: TPayment; // Метод оплаты
	address: string; // Адрес доставки
}

__Класс FormContactsComponent__ наследуется от универсального компонента Form. Является формой с 2 полями ( email, телефон). Валидируется.

constructor(container: HTMLFormElement, events: IEvents ) - в конструкторе принимает контейнер, который является родителем, а также events - методы presenter слоя для взаимодействия view и modal. Имплементирует  интерфейс FormContactsView.

interface IFormContactsView {
	email: string; // Email адрес
	phone: string; // Контактный телефон
}

__Класс SuccessComponent__ наследуется от абстрактного класса Component, содержит информацию о списанной сумме, а также при завершении заказа очищает корзину. 

constructor(container: HTMLFormElement, events: IEvents ) - в конструкторе принимает контейнер, который является родителем, а также events - методы presenter слоя для взаимодействия view и modal. Имплементирует  интерфейс ISuccessfulOrderView.

interface ISuccessfulOrderView {
	totalAmount: number; // Итоговая сумма заказа
}
```

## Слой Presenter 

```TypeScript 


__Класс ApiClient__ необходим для получения данных с сервера. Имеет такие методы как:
getProducts() - запрос на получение всех продуктов 
getProduct() - запрос на получение конкретного продукта по ID
createOrder() - создание заказа.
Имплементирует интерфейс IApiClient.

interface IApiClient {
    getProducts(): Promise<IProductItem[]>; // Получить список продуктов
    getProduct(id: string): Promise<IProductItem>; // Получить информацию о продукте по его идентификатору
    createOrder(order: IOrder): Promise<IOrderDto>; // Создать новый заказ
}

__Класс EventEmitter__ описан в базовых классах ( начало ReadMe)



## Архитектура проекта
Проект "Веб-ларек" следует архитектурному паттерну MVP (Model View Presenter), который включает несколько ключевых компонентов для обеспечения модульности, переиспользуемости и легкости сопровождения.
Взаимодействия внутри приложения происходят через события. Модели инициализируют события, слушатели событий в основном коде выполняют передачу данных компонентам отображения, а также вычислениями между этой передачей, и еще они меняют значения в моделях.
 

### Основные части проекта:
### 1. Слой Model:
	Содержит интерфейсы данных для продуктов, заказов и корзины.
* __IProductItem__: Описывает атрибуты продукта.
* __IProductList__: Содержит массив продуктов.
* __IOrder__: Определяет структуру заказа.
* __ICartItem__: Представляет продукт в корзине.
* __ICart__: Управляет содержимым корзины и вычисляет итоговую стоимость.

### 2. Слой View:
	Определяет интерфейсы представлений для отображения данных и взаимодействия с пользователем.
* __IPageView__: Содержит элементы для отображения главной страницы, такие как счетчик корзины и список продуктов.
* __ICardView__: Описывает структуру отдельного продукта на карточке.
* __ICartView__: Представляет содержимое корзины.
* __IFormView__: Отвечает за валидацию форм.
* __IModalView__: Управляет модальными окнами.

### 3. Слой Presenter:
	Обеспечивает управление бизнес-логикой и взаимодействием между моделью, представлениями и API.
* __IEvents__ предоставляет механизмы для обработки событий.
* __IApiClient__ определяет интерфейс для работы с внешним API, таким как получение продуктов и создание заказов.

### Взаимодействие между частями проекта:
### Модульность:

* Компоненты представления используются для отображения данных и обработки пользовательского ввода.
* Презентеры и контроллеры управляют бизнес-логикой и взаимодействием с моделью данных и API.

### Обмен данными:

* Данные о продуктах и заказах передаются между моделью, представлениями и контроллерами через определенные интерфейсы и методы.

### Пример процесса в приложении:
* Взаимодействие с пользователем осуществляется через представления, которые обновляются при изменении данных в модели.
* Событийная модель (IEvents) используется для управления событиями и уведомлений между компонентами.

### Основные типы и интерфейсы:

* __IProductItem__, __IProductList__, __IOrder__, __ICartItem__, __ICart__: модели данных для продуктов, заказов и корзины.
* __IPageView__, __ICardView__, __ICartView__, __IFormView__, __IModalView__: __интерфейсы__ представлений для отображения информации и взаимодействия с пользователем.
* __IEvents__, __IApiClient__: интерфейсы для управления событиями и взаимодействия с внешним API.

